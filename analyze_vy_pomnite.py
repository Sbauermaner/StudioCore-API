#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""–ê–Ω–∞–ª–∏–∑ —Å—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –ï—Å–µ–Ω–∏–Ω–∞ '–í—ã –ø–æ–º–Ω–∏—Ç–µ' —á–µ—Ä–µ–∑ StudioCoreV6"""

import json
from studiocore.core_v6 import StudioCoreV6

text = """–í—ã –ø–æ–º–Ω–∏—Ç–µ,

–í—ã –≤—Å—ë, –∫–æ–Ω–µ—á–Ω–æ, –ø–æ–º–Ω–∏—Ç–µ,

–ö–∞–∫ —è —Å—Ç–æ—è–ª,

–ü—Ä–∏–±–ª–∏–∑–∏–≤—à–∏—Å—å –∫ —Å—Ç–µ–Ω–µ,

–í–∑–≤–æ–ª–Ω–æ–≤–∞–Ω–Ω–æ —Ö–æ–¥–∏–ª–∏ –≤—ã –ø–æ –∫–æ–º–Ω–∞—Ç–µ

–ò —á—Ç–æ-—Ç–æ —Ä–µ–∑–∫–æ–µ

–í –ª–∏—Ü–æ –±—Ä–æ—Å–∞–ª–∏ –º–Ω–µ.



–í—ã –≥–æ–≤–æ—Ä–∏–ª–∏:

–ù–∞–º –ø–æ—Ä–∞ —Ä–∞—Å—Å—Ç–∞—Ç—å—Å—è,

–ß—Ç–æ –≤–∞—Å –∏–∑–º—É—á–∏–ª–∞

–ú–æ—è —à–∞–ª—å–Ω–∞—è –∂–∏–∑–Ω—å,

–ß—Ç–æ –≤–∞–º –ø–æ—Ä–∞ –∑–∞ –¥–µ–ª–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å—Å—è,

–ê –º–æ–π —É–¥–µ–ª ‚Äî

–ö–∞—Ç–∏—Ç—å—Å—è –¥–∞–ª—å—à–µ, –≤–Ω–∏–∑.



–õ—é–±–∏–º–∞—è!

–ú–µ–Ω—è –≤—ã –Ω–µ –ª—é–±–∏–ª–∏.

–ù–µ –∑–Ω–∞–ª–∏ –≤—ã, —á—Ç–æ –≤ —Å–æ–Ω–º–∏—â–µ –ª—é–¥—Å–∫–æ–º

–Ø –±—ã–ª –∫–∞–∫ –ª–æ—à–∞–¥—å, –∑–∞–≥–Ω–∞–Ω–Ω–∞—è –≤ –º—ã–ª–µ,

–ü—Ä–∏—à–ø–æ—Ä–µ–Ω–Ω–∞—è —Å–º–µ–ª—ã–º –µ–∑–¥–æ–∫–æ–º.



–ù–µ –∑–Ω–∞–ª–∏ –≤—ã,

–ß—Ç–æ —è –≤ —Å–ø–ª–æ—à–Ω–æ–º –¥—ã–º—É,

–í —Ä–∞–∑–≤–æ—Ä–æ—á–µ–Ω–Ω–æ–º –±—É—Ä–µ–π –±—ã—Ç–µ

–° —Ç–æ–≥–æ –∏ –º—É—á–∞—é—Å—å, —á—Ç–æ –Ω–µ –ø–æ–π–º—É ‚Äî

–ö—É–¥–∞ –Ω–µ—Å–µ—Ç –Ω–∞—Å —Ä–æ–∫ —Å–æ–±—ã—Ç–∏–π.



–õ–∏—Ü–æ–º –∫ –ª–∏—Ü—É

–õ–∏—Ü–∞ –Ω–µ —É–≤–∏–¥–∞—Ç—å.

–ë–æ–ª—å—à–æ–µ –≤–∏–¥–∏—Ç—Å—è –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω—å–µ.

–ö–æ–≥–¥–∞ –∫–∏–ø–∏—Ç –º–æ—Ä—Å–∫–∞—è –≥–ª–∞–¥—å ‚Äî

–ö–æ—Ä–∞–±–ª—å –≤ –ø–ª–∞—á–µ–≤–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω—å–µ.



–ó–µ–º–ª—è ‚Äî –∫–æ—Ä–∞–±–ª—å!

–ù–æ –∫—Ç–æ-—Ç–æ –≤–¥—Ä—É–≥

–ó–∞ –Ω–æ–≤–æ–π –∂–∏–∑–Ω—å—é, –Ω–æ–≤–æ–π —Å–ª–∞–≤–æ–π

–í –ø—Ä—è–º—É—é –≥—É—â—É –±—É—Ä—å –∏ –≤—å—é–≥

–ï–µ –Ω–∞–ø—Ä–∞–≤–∏–ª –≤–µ–ª–∏—á–∞–≤–æ.



–ù—É –∫—Ç–æ –∂ –∏–∑ –Ω–∞—Å –Ω–∞ –ø–∞–ª—É–±–µ –±–æ–ª—å—à–æ–π

–ù–µ –ø–∞–¥–∞–ª, –Ω–µ –±–ª–µ–≤–∞–ª –∏ –Ω–µ —Ä—É–≥–∞–ª—Å—è?

–ò—Ö –º–∞–ª–æ, —Å –æ–ø—ã—Ç–Ω–æ–π –¥—É—à–æ–π,

–ö—Ç–æ –∫—Ä–µ–ø–∫–∏–º –≤ –∫–∞—á–∫–µ –æ—Å—Ç–∞–≤–∞–ª—Å—è.



–¢–æ–≥–¥–∞ –∏ —è,

–ü–æ–¥ –¥–∏–∫–∏–π —à—É–º,

–ù–æ –∑—Ä–µ–ª–æ –∑–Ω–∞—é—â–∏–π —Ä–∞–±–æ—Ç—É,

–°–ø—É—Å—Ç–∏–ª—Å—è –≤ –∫–æ—Ä–∞–±–µ–ª—å–Ω—ã–π —Ç—Ä—é–º,

–ß—Ç–æ–± –Ω–µ —Å–º–æ—Ç—Ä–µ—Ç—å –ª—é–¥—Å–∫—É—é —Ä–≤–æ—Ç—É.



–¢–æ—Ç —Ç—Ä—é–º –±—ã–ª ‚Äî

–†—É—Å—Å–∫–∏–º –∫–∞–±–∞–∫–æ–º.

–ò —è —Å–∫–ª–æ–Ω–∏–ª—Å—è –Ω–∞–¥ —Å—Ç–∞–∫–∞–Ω–æ–º,

–ß—Ç–æ–±, –Ω–µ —Å—Ç—Ä–∞–¥–∞—è –Ω–∏ –æ –∫–æ–º,

–°–µ–±—è —Å–≥—É–±–∏—Ç—å

–í —É–≥–∞—Ä–µ –ø—å—è–Ω–æ–º.



–õ—é–±–∏–º–∞—è!

–Ø –º—É—á–∏–ª –≤–∞—Å,

–£ –≤–∞—Å –±—ã–ª–∞ —Ç–æ—Å–∫–∞

–í –≥–ª–∞–∑–∞—Ö —É—Å—Ç–∞–ª—ã—Ö:

–ß—Ç–æ —è –ø—Ä–µ–¥ –≤–∞–º–∏ –Ω–∞–ø–æ–∫–∞–∑

–°–µ–±—è —Ä–∞—Å—Ç—Ä–∞—á–∏–≤–∞–ª –≤ —Å–∫–∞–Ω–¥–∞–ª–∞—Ö.



–ù–æ –≤—ã –Ω–µ –∑–Ω–∞–ª–∏,

–ß—Ç–æ –≤ —Å–ø–ª–æ—à–Ω–æ–º –¥—ã–º—É,

–í —Ä–∞–∑–≤–æ—Ä–æ—á–µ–Ω–Ω–æ–º –±—É—Ä–µ–π –±—ã—Ç–µ

–° —Ç–æ–≥–æ –∏ –º—É—á–∞—é—Å—å,

–ß—Ç–æ –Ω–µ –ø–æ–π–º—É,

–ö—É–¥–∞ –Ω–µ—Å–µ—Ç –Ω–∞—Å —Ä–æ–∫ —Å–æ–±—ã—Ç–∏–π‚Ä¶



–¢–µ–ø–µ—Ä—å –≥–æ–¥–∞ –ø—Ä–æ—à–ª–∏.

–Ø –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ –∏–Ω–æ–º.

–ò —á—É–≤—Å—Ç–≤—É—é –∏ –º—ã—Å–ª—é –ø–æ-–∏–Ω–æ–º—É.

–ò –≥–æ–≤–æ—Ä—é –∑–∞ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–º –≤–∏–Ω–æ–º:

–•–≤–∞–ª–∞ –∏ —Å–ª–∞–≤–∞ —Ä—É–ª–µ–≤–æ–º—É!



–°–µ–≥–æ–¥–Ω—è —è

–í —É–¥–∞—Ä–µ –Ω–µ–∂–Ω—ã—Ö —á—É–≤—Å—Ç–≤.

–Ø –≤—Å–ø–æ–º–Ω–∏–ª –≤–∞—à—É –≥—Ä—É—Å—Ç–Ω—É—é —É—Å—Ç–∞–ª–æ—Å—Ç—å.

–ò –≤–æ—Ç —Ç–µ–ø–µ—Ä—å

–Ø —Å–æ–æ–±—â–∏—Ç—å –≤–∞–º –º—á—É—Å—å,

–ö–∞–∫–æ–≤ —è –±—ã–ª,

–ò —á—Ç–æ —Å–æ –º–Ω–æ—é —Å—Ç–∞–ª–æ—Å—å!



–õ—é–±–∏–º–∞—è!

–°–∫–∞–∑–∞—Ç—å –ø—Ä–∏—è—Ç–Ω–æ –º–Ω–µ:

–Ø –∏–∑–±–µ–∂–∞–ª –ø–∞–¥–µ–Ω—å—è —Å –∫—Ä—É—á–∏.

–¢–µ–ø–µ—Ä—å –≤ –°–æ–≤–µ—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ

–Ø —Å–∞–º—ã–π —è—Ä–æ—Å—Ç–Ω—ã–π –ø–æ–ø—É—Ç—á–∏–∫.



–Ø —Å—Ç–∞–ª –Ω–µ —Ç–µ–º,

–ö–µ–º –±—ã–ª —Ç–æ–≥–¥–∞.

–ù–µ –º—É—á–∏–ª –±—ã —è –≤–∞—Å,

–ö–∞–∫ —ç—Ç–æ –±—ã–ª–æ —Ä–∞–Ω—å—à–µ.

–ó–∞ –∑–Ω–∞–º—è –≤–æ–ª—å–Ω–æ—Å—Ç–∏

–ò —Å–≤–µ—Ç–ª–æ–≥–æ —Ç—Ä—É–¥–∞

–ì–æ—Ç–æ–≤ –∏–¥—Ç–∏ —Ö–æ—Ç—å –¥–æ –õ–∞-–ú–∞–Ω—à–∞."""

print("=" * 80)
print("–ê–ù–ê–õ–ò–ó –°–¢–ò–•–û–¢–í–û–†–ï–ù–ò–Ø –ï–°–ï–ù–ò–ù–ê '–í–´ –ü–û–ú–ù–ò–¢–ï'")
print("=" * 80)
print("\n–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑...\n")

try:
    core = StudioCoreV6()
    result = core.analyze(text, preferred_gender="auto")
    
    if not result.get("ok", True):
        print(f"‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞: {result.get('error', 'Unknown error')}")
        exit(1)
    
    print("‚úÖ –ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!\n")
    print("=" * 80)
    print("–†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê")
    print("=" * 80)
    
    # 1. TLP
    print("\n1. üéØ TLP (Truth / Love / Pain):")
    print("-" * 80)
    tlp = result.get("tlp", {})
    print(f"   Truth: {tlp.get('truth', 0):.3f}")
    print(f"   Love: {tlp.get('love', 0):.3f}")
    print(f"   Pain: {tlp.get('pain', 0):.3f}")
    print(f"   Conscious Frequency: {tlp.get('conscious_frequency', 0):.3f}")
    
    # 2. –≠–º–æ—Ü–∏–∏
    print("\n2. üí≠ –≠–ú–û–¶–ò–û–ù–ê–õ–¨–ù–´–ô –ü–†–û–§–ò–õ–¨:")
    print("-" * 80)
    emotion = result.get("emotion", {})
    emotion_profile = emotion.get("profile", {})
    if emotion_profile:
        sorted_emotions = sorted(emotion_profile.items(), key=lambda x: x[1], reverse=True)
        print("   –¢–æ–ø-7 —ç–º–æ—Ü–∏–π:")
        for i, (emotion_name, intensity) in enumerate(sorted_emotions[:7], 1):
            print(f"      {i}. {emotion_name}: {intensity:.3f}")
    
    # 3. BPM
    print("\n3. üéµ BPM (–¢–µ–º–ø):")
    print("-" * 80)
    bpm = result.get("bpm", {})
    print(f"   Estimate: {bpm.get('estimate', '‚Äî')}")
    if isinstance(bpm, dict):
        flow_estimate = bpm.get("flow_estimate")
        if flow_estimate:
            print(f"   Flow Estimate: {flow_estimate}")
    
    # 4. –ñ–∞–Ω—Ä –∏ —Å—Ç–∏–ª—å
    print("\n4. üé® –ñ–ê–ù–† –ò –°–¢–ò–õ–¨:")
    print("-" * 80)
    style = result.get("style", {})
    print(f"   Genre: {style.get('genre', '‚Äî')}")
    print(f"   Macro Genre: {style.get('macro_genre', '‚Äî')}")
    print(f"   Mood: {style.get('mood', '‚Äî')}")
    color_wave = style.get("color_wave")
    if color_wave:
        print(f"   Color Wave: {color_wave}")
    
    # 5. –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
    print("\n5. üéπ –¢–û–ù–ê–õ–¨–ù–û–°–¢–¨:")
    print("-" * 80)
    tone = result.get("tone", {})
    key = tone.get("key", "‚Äî")
    mode = tone.get("mode", "‚Äî")
    print(f"   Key: {key}")
    print(f"   Mode: {mode}")
    
    # 6. –í–æ–∫–∞–ª
    print("\n6. üé§ –í–û–ö–ê–õ–¨–ù–´–ï –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò:")
    print("-" * 80)
    vocal = result.get("vocal", {})
    print(f"   Gender: {vocal.get('gender', '‚Äî')}")
    print(f"   Style: {vocal.get('style', '‚Äî')}")
    techniques = vocal.get("techniques", [])
    if techniques:
        print(f"   –¢–µ—Ö–Ω–∏–∫–∏: {', '.join(techniques[:5])}")
    
    # 7. –°—Ç—Ä—É–∫—Ç—É—Ä–∞
    print("\n7. üìê –°–¢–†–£–ö–¢–£–†–ê:")
    print("-" * 80)
    structure = result.get("structure", {})
    sections = structure.get("sections", [])
    headers = structure.get("headers", [])
    print(f"   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–∫—Ü–∏–π: {len(sections)}")
    if headers:
        print("   –ù–∞–∑–≤–∞–Ω–∏—è —Å–µ–∫—Ü–∏–π:")
        for i, h in enumerate(headers[:10], 1):
            tag = h.get("tag", "?")
            print(f"      {i}. {tag}")
    
    # 8. RDE
    print("\n8. üìä RDE (–†–µ–∑–æ–Ω–∞–Ω—Å / –§—Ä–∞–∫—Ç—É—Ä–∞ / –≠–Ω—Ç—Ä–æ–ø–∏—è):")
    print("-" * 80)
    rde = result.get("rde", {})
    print(f"   Resonance: {rde.get('resonance', '‚Äî')}")
    print(f"   Fracture: {rde.get('fracture', '‚Äî')}")
    print(f"   Entropy: {rde.get('entropy', '‚Äî')}")
    
    # 9. FANF –ø—Ä–æ–º–ø—Ç—ã
    print("\n9. üìù FANF –ü–†–û–ú–ü–¢–´:")
    print("-" * 80)
    fanf = result.get("fanf", {})
    style_prompt = fanf.get("style_prompt", "")
    lyrics_prompt = fanf.get("lyrics_prompt", "")
    
    print("   Style Prompt:")
    if style_prompt:
        print(f"      {style_prompt[:250]}...")
    print()
    
    print("   Lyrics Prompt (–ø–µ—Ä–≤—ã–µ 15 —Å—Ç—Ä–æ–∫):")
    if lyrics_prompt:
        lines = lyrics_prompt.split("\n")
        for line in lines[:15]:
            if line.strip():
                print(f"      {line[:80]}")
    
    # 10. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
    print("\n10. üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê:")
    print("-" * 80)
    diagnostics = result.get("diagnostics", {})
    tlp_block = diagnostics.get("tlp_block", "")
    rde_block = diagnostics.get("rde_block", "")
    if tlp_block:
        print(f"   {tlp_block}")
    if rde_block:
        print(f"   {rde_block}")
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    output_file = "vy_pomnite_result.json"
    with open(output_file, "w", encoding="utf-8") as f:
        json.dump(result, f, ensure_ascii=False, indent=2)
    
    print("\n" + "=" * 80)
    print("‚úÖ –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù")
    print(f"üíæ –ü–æ–ª–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤: {output_file}")
    print("=" * 80)
    
except Exception as e:
    print(f"\n‚ùå –û—à–∏–±–∫–∞: {e}")
    import traceback
    traceback.print_exc()
    exit(1)

