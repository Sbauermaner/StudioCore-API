# –ê—É–¥–∏—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö –∂–∞–Ω—Ä–æ–≤ –≤ –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ

## –î–∞—Ç–∞: 2025-01-XX

## –û–±–∑–æ—Ä

–ü—Ä–æ–≤–µ–¥–µ–Ω –∞—É–¥–∏—Ç –∏ —É–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö –∂–∞–Ω—Ä–æ–≤ –≤ –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ —Å —É—á–µ—Ç–æ–º —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ—Å—ã–ª–∞.

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø

### 1. –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö –∂–∞–Ω—Ä–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `domain_genre` –º–æ–≥ –±—ã—Ç—å `None` –¥–∞–∂–µ –¥–ª—è –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤
- –õ–∏—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–µ –≤—Å–µ–≥–¥–∞ —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –∂–∞–Ω—Ä–∞
- –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ—Å—ã–ª –Ω–µ –≤—Å–µ–≥–¥–∞ –≤–ª–∏—è–ª –Ω–∞ –≤—ã–±–æ—Ä –∂–∞–Ω—Ä–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–∞–∂–µ –µ—Å–ª–∏ `domain_genre = None`
- –î–æ–±–∞–≤–ª–µ–Ω fallback –¥–ª—è –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤
- –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è EDM –≤ –ª–∏—Ä–∏—á–µ—Å–∫–∏–µ –∂–∞–Ω—Ä—ã
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ—Å—ã–ª–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∂–∞–Ω—Ä–∞

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `core_v6.py`:**

```python
# –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö –∂–∞–Ω—Ä–æ–≤ –≤ –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ
# –ï—Å–ª–∏ domain_genre –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –Ω–æ –µ—Å—Ç—å –ª–∏—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ - –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∂–∞–Ω—Ä
if not domain_genre or domain_genre == "unknown":
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
    if poetic_bias > 0.15 or lyric_bias > 0.15 or lyrical_emotion_score > 0.2:
        if gothic_bias > 0.2:
            domain_genre = "gothic_poetry"
            genre_source = "lyrical_to_music_conversion"
        elif poetic_bias > 0.25 or lyric_bias > 0.25:
            domain_genre = "lyrical_song"
            genre_source = "lyrical_to_music_conversion"
        elif dramatic_bias > 0.25:
            domain_genre = "cinematic"
            genre_source = "lyrical_to_music_conversion"
        else:
            # Fallback –¥–ª—è –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤
            domain_genre = "lyrical_song"
            genre_source = "lyrical_fallback"
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ—Å—ã–ª –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∂–∞–Ω—Ä–∞
    elif emotion_profile:
        dominant_emotion = max(emotion_profile.items(), key=lambda x: x[1])[0]
        pain_level = tlp_profile.get("pain", 0.0)
        love_level = tlp_profile.get("love", 0.0)
        
        # –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ—Å—ã–ª –≤–ª–∏—è–µ—Ç –Ω–∞ –∂–∞–Ω—Ä
        if pain_level > 0.6:
            if gothic_bias > 0.15:
                domain_genre = "gothic_poetry"
            else:
                domain_genre = "lyrical_song"
            genre_source = "emotion_based"
        elif love_level > 0.6:
            domain_genre = "lyrical_song"
            genre_source = "emotion_based"
        elif dominant_emotion in ("sadness", "melancholy"):
            domain_genre = "lyrical_song"
            genre_source = "emotion_based"

# –§–∏–Ω–∞–ª—å–Ω—ã–π fallback –µ—Å–ª–∏ –∂–∞–Ω—Ä –≤—Å–µ –µ—â–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω
if not domain_genre or domain_genre == "unknown":
    domain_genre = "lyrical_song"  # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π fallback –¥–ª—è –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤
    genre_source = "final_fallback"
```

---

### 2. –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ style_genre

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `style_genre` –º–æ–≥ –±—ã—Ç—å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–∞–∂–µ –µ—Å–ª–∏ `domain_genre` –±—ã–ª –æ–ø—Ä–µ–¥–µ–ª–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è `style_genre`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `domain_genre` –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –ª–∏—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∏–Ω–∞–ª—å–Ω—ã–π fallback –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–º–æ—Ü–∏–π

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

```python
# –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –∂–∞–Ω—Ä–∞ —Å —É—á–µ—Ç–æ–º –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ—Å—ã–ª–∞
style_genre = (
    style_commands.get("genre")
    or semantic_hints.get("style", {}).get("genre")
    or domain_genre  # –ò—Å–ø–æ–ª—å–∑—É–µ–º domain_genre –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –ª–∏—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
    or self.style_engine.genre_selection(emotion_profile, tlp_profile)
)

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –∂–∞–Ω—Ä –≤—Å–µ –µ—â–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ—Å—ã–ª
if not style_genre or style_genre == "unknown" or style_genre == "auto":
    if domain_genre:
        style_genre = domain_genre
    else:
        # –§–∏–Ω–∞–ª—å–Ω—ã–π fallback –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–º–æ—Ü–∏–π
        style_genre = self.style_engine.genre_selection(emotion_profile, tlp_profile) or "lyrical_song"
```

---

## üìä –õ–û–ì–ò–ö–ê –ü–†–ï–û–ë–†–ê–ó–û–í–ê–ù–ò–Ø

### –ü–æ—Ç–æ–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∂–∞–Ω—Ä–∞:

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ domain_genre:**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `genre_matrix.evaluate(feature_map)`
   - –ï—Å–ª–∏ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ª–∏—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
   - –ï—Å–ª–∏ –ª–∏—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–∞–π–¥–µ–Ω—ã ‚Üí `lyrical_song` –∏–ª–∏ `gothic_poetry`
   - –ï—Å–ª–∏ –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–µ—Ç, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ—Å—ã–ª
   - –§–∏–Ω–∞–ª—å–Ω—ã–π fallback ‚Üí `lyrical_song`

2. **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ EDM –≤ –ª–∏—Ä–∏—á–µ—Å–∫–∏–µ –∂–∞–Ω—Ä—ã:**
   - –ï—Å–ª–∏ `domain_genre == "edm"` –∏ –µ—Å—Ç—å –ª–∏—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ ‚Üí `lyrical_song` –∏–ª–∏ `gothic_poetry`
   - –ï—Å–ª–∏ `domain_genre == "edm"` –∏ –µ—Å—Ç—å –¥—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ ‚Üí `cinematic`

3. **–í—ã–±–æ—Ä style_genre:**
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: user override ‚Üí semantic hints ‚Üí domain_genre ‚Üí emotion-based selection
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `domain_genre` –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –ª–∏—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏

---

## üéØ –£–ß–ï–¢ –≠–ú–û–¶–ò–û–ù–ê–õ–¨–ù–û–ì–û –ü–û–°–´–õ–ê

### –≠–º–æ—Ü–∏–∏ –≤–ª–∏—è—é—Ç –Ω–∞ –∂–∞–Ω—Ä:

1. **Pain > 0.6:**
   - –ï—Å–ª–∏ `gothic_bias > 0.15` ‚Üí `gothic_poetry`
   - –ò–Ω–∞—á–µ ‚Üí `lyrical_song`

2. **Love > 0.6:**
   - ‚Üí `lyrical_song`

3. **Sadness / Melancholy:**
   - ‚Üí `lyrical_song`

4. **TLP –≤–ª–∏—è–µ—Ç –Ω–∞ –∂–∞–Ω—Ä:**
   - `pain` ‚Üí gothic –∏–ª–∏ lyrical
   - `love` ‚Üí lyrical
   - `truth` ‚Üí –≤–ª–∏—è–µ—Ç –Ω–∞ –æ–±—â–∏–π –≤—ã–±–æ—Ä

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π:
- `domain_genre` –º–æ–≥ –±—ã—Ç—å `None`
- –õ–∏—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–µ –≤—Å–µ–≥–¥–∞ —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å
- –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ—Å—ã–ª –Ω–µ –≤—Å–µ–≥–¥–∞ –≤–ª–∏—è–ª –Ω–∞ –∂–∞–Ω—Ä

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:
- ‚úÖ `domain_genre` –≤—Å–µ–≥–¥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω (fallback –Ω–∞ `lyrical_song`)
- ‚úÖ –õ–∏—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –∂–∞–Ω—Ä–∞
- ‚úÖ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ—Å—ã–ª –≤–ª–∏—è–µ—Ç –Ω–∞ –≤—ã–±–æ—Ä –∂–∞–Ω—Ä–∞
- ‚úÖ –õ–æ–≥–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –õ–æ–≥–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö –∂–∞–Ω—Ä–æ–≤ –≤ –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

**–£–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–∞–∂–µ –µ—Å–ª–∏ `domain_genre = None`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω fallback –¥–ª—è –ª–∏—Ä–∏—á–µ—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è EDM –≤ –ª–∏—Ä–∏—á–µ—Å–∫–∏–µ –∂–∞–Ω—Ä—ã
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ—Å—ã–ª–∞
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ `style_genre`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –õ–∏—Ä–∏—á–µ—Å–∫–∏–µ –∂–∞–Ω—Ä—ã —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –∂–∞–Ω—Ä—ã —Å —É—á–µ—Ç–æ–º —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ—Å—ã–ª–∞ –∏ –≤—Å–µ–π –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞!

