{
  "StudioCore_Spec": {
    "version": "6.1",
    "description": "Unified specification for StudioCore v6.x engines, diagnostics, overrides, and Codex-driven code synchronization.",

    "required_modules": [
      "__init__.py",
      "core_v6.py",
      "emotion.py",
      "tone.py",
      "rhythm.py",
      "vocals.py",
      "style.py",
      "instrument.py",
      "adapter.py",
      "text_utils.py",
      "monolith_v4_3_1.py",
      "fallback.py",
      "user_override_manager.py"
    ],

    "required_classes": {
      "core_v6.py": ["StudioCoreV6"],
      "monolith_v4_3_1.py": ["StudioCoreV5"],
      "fallback.py": ["StudioCoreFallback"],
      "user_override_manager.py": ["UserOverrides", "UserOverrideManager"]
    },

    "required_methods": {
      "StudioCoreV6": [
        "analyze",
        "_backend_analyze",
        "_merge_user_params",
        "_auto_generate_missing_params",
        "_finalize_result"
      ],
      "StudioCoreV5": [
        "analyze",
        "emotion",
        "style",
        "tone",
        "rhythm"
      ],
      "StudioCoreFallback": [
        "analyze"
      ],
      "UserOverrides": [
        "__init__",
        "from_dict"
      ],
      "UserOverrideManager": [
        "__init__",
        "resolve_bpm",
        "_get_meta_bpm",
        "apply_to_rhythm",
        "apply_to_style",
        "apply_to_vocals",
        "debug_summary"
      ]
    },

    "logical_engines": [
      "TextStructureEngine",
      "EmotionEngine",
      "ColorEmotionEngine",
      "VocalEngine",
      "BreathingEngine",
      "BPMEngine",
      "MeaningVelocityEngine",
      "TonalityEngine",
      "InstrumentationEngine",
      "REM_Synchronizer",
      "ZeroPulseEngine",
      "CommandInterpreter",
      "StyleEngine",
      "LyricsAnnotationEngine",
      "FinalCompiler",
      "UserOverrideEngine"
    ],

    "engine_functions": {
      "TextStructureEngine": [
        "auto_section_split",
        "detect_intro",
        "detect_verse",
        "detect_prechorus",
        "detect_chorus",
        "detect_bridge",
        "detect_outro",
        "detect_meta_pause",
        "detect_zero_pulse"
      ],

      "EmotionEngine": [
        "emotion_detection",
        "emotion_intensity_curve",
        "emotion_pivot_points",
        "secondary_emotion_detection",
        "emotion_conflict_map"
      ],

      "ColorEmotionEngine": [
        "assign_color_by_emotion",
        "generate_color_wave",
        "color_transition_map"
      ],

      "VocalEngine": [
        "detect_voice_gender",
        "detect_voice_type",
        "detect_voice_tone",
        "detect_vocal_style",
        "vocal_dynamics_map",
        "vocal_intensity_curve"
      ],

      "BreathingEngine": [
        "detect_inhale_points",
        "detect_short_breath",
        "detect_broken_breath",
        "detect_spasms",
        "detect_emotional_breathing",
        "breath_to_emotion_sync"
      ],

      "BPMEngine": [
        "text_bpm_estimation",
        "emotion_bpm_mapping",
        "meaning_bpm_curve",
        "breathing_bpm_integration",
        "poly_rhythm_detection"
      ],

      "MeaningVelocityEngine": [
        "semantic_shift_detection",
        "meaning_acceleration",
        "meaning_fracture_detection",
        "meaning_curve_generation"
      ],

      "TonalityEngine": [
        "mode_detection",
        "major_minor_classifier",
        "section_key_selection",
        "modal_shift_detection",
        "key_transition_curve"
      ],

      "InstrumentationEngine": [
        "instrument_selection",
        "instrument_based_on_emotion",
        "instrument_based_on_voice",
        "instrument_color_sync",
        "instrument_rhythm_sync"
      ],

      "REM_Synchronizer": [
        "detect_layer_conflicts",
        "resolve_layer_conflicts",
        "assign_dominant_layer",
        "align_layers_for_final_output"
      ],

      "ZeroPulseEngine": [
        "detect_zero_pulse",
        "vacuum_beat_state",
        "silence_as_emotion",
        "silence_as_transition"
      ],

      "CommandInterpreter": [
        "detect_commands_in_text",
        "execute_bpm_commands",
        "execute_key_commands",
        "execute_rhythm_commands",
        "execute_emotion_commands"
      ],

      "StyleEngine": [
        "genre_selection",
        "mood_selection",
        "instrumentation_style",
        "vocal_style",
        "visual_style",
        "tone_style",
        "final_style_prompt_build"
      ],

      "LyricsAnnotationEngine": [
        "add_vocal_annotations",
        "add_breath_annotations",
        "add_tonal_annotations",
        "add_emotional_annotations",
        "add_rhythm_annotations"
      ],

      "FinalCompiler": [
        "merge_all_layers",
        "generate_final_structure",
        "generate_final_prompt",
        "generate_final_annotations",
        "consistency_check"
      ],

      "UserOverrideEngine": [
        "resolve_bpm",
        "apply_to_rhythm",
        "apply_to_style",
        "apply_to_vocals"
      ]
    },

    "color_engine_rules": {
      "visibility": {
        "exposed_in_style_prompt": false,
        "exposed_only_if_user_explicitly_requests_color": true
      },
      "internal_usage": [
        "emotion → color map",
        "tone → color harmonic match",
        "pain/truth/love → color shift",
        "BPM → color intensity",
        "structure → color transitions"
      ],
      "dependencies": [
        "emotion.py",
        "tone.py",
        "tlp_engine",
        "rhythm.py",
        "style.py"
      ],
      "purpose": [
        "energy glow",
        "vocal profile correction",
        "instrument selection",
        "section transitions",
        "emotional field stabilization"
      ],
      "output_rules": {
        "write_to_result_json": true,
        "write_to_prompt_suno_style": false,
        "write_to_prompt_suno_lyrics": false,
        "write_to_annotations": false,
        "write_to_internal_diagnostics": true
      }
    },

    "override_priority": [
      "user_overrides",
      "meta_directives",
      "auto_analysis"
    ],

    "reserved_keywords": {
      "deprecated": ["mode", "overlay"],
      "forbidden": ["overlay"]
    },

    "file_generation_rules": {
      "enabled": true,
      "create_missing_files": true,
      "create_missing_classes": true,
      "create_missing_functions": true,
      "add_missing_imports": true,
      "confirm_before_writing": true
    },

    "validation_rules": {
      "must_have_all_modules": true,
      "must_have_all_classes": true,
      "must_have_all_required_methods": true,
      "must_have_all_required_engine_functions": true,
      "no_missing_imports": true,
      "no_signature_mismatches": true,
      "no_type_errors_on_runtime": true
    }
  }
}
